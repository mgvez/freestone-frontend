!function(){"use strict";var e=function(t){var n=t,o=function(){return n};return{get:o,set:function(e){n=e},clone:function(){return e(o())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),o=tinymce.util.Tools.resolve("tinymce.util.Tools"),s=n.DOM.uniqueId(),i=function(e,t){var i=o.toArray(e.getElementsByTagName("link"));if(0===o.grep(i,(function(e){return e.id===s})).length){var c=n.DOM.create("link",{id:s,rel:"stylesheet",href:t});e.getElementsByTagName("head")[0].appendChild(c)}},c=function(e,t,n){var o=e.dom,s=function(e){return e.settings.visualblocks_content_css}(e);i(e.getDoc(),s||t+"/css/visualblocks.css"),o.toggleClass(e.getBody(),"mce-visualblocks"),n.set(!n.get()),function(e,t){e.fire("VisualBlocks",{state:t})}(e,n.get())},l=function(e,t){return function(n){var o=n.control;o.active(t.get()),e.on("VisualBlocks",(function(e){o.active(e.state)}))}};t.add("visualblocks",(function(t,n){var o=e(!1);(function(e,t,n){e.addCommand("mceVisualBlocks",(function(){c(e,t,n)}))})(t,n,o),function(e,t){e.addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:l(e,t)}),e.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:l(e,t),selectable:!0,context:"view",prependToContext:!0})}(t,o),function(e,t,n){e.on("PreviewFormats AfterPreviewFormats",(function(t){n.get()&&e.dom.toggleClass(e.getBody(),"mce-visualblocks","afterpreviewformats"===t.type)})),e.on("init",(function(){(function(e){return e.getParam("visualblocks_default_state",!1)})(e)&&c(e,t,n)})),e.on("remove",(function(){e.dom.removeClass(e.getBody(),"mce-visualblocks")}))}(t,n,o)}))}();