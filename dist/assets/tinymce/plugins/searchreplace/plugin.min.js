!function(){"use strict";var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return e(r())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.util.Tools");function r(e){return e&&1===e.nodeType&&"false"===e.contentEditable}var a=function(e,t,n,a,i){var o,d,c,l,s,u,f=[],g=0;function m(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(t>0){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}if(c=t.ownerDocument,l=i.getBlockElements(),s=i.getWhiteSpaceElements(),u=i.getShortEndedElements(),d=function e(t){var n;if(3===t.nodeType)return t.data;if(s[t.nodeName]&&!l[t.nodeName])return"";if(n="",r(t))return"\n";if((l[t.nodeName]||u[t.nodeName])&&(n+="\n"),t=t.firstChild)for(;n+=e(t),t=t.nextSibling;);return n}(t)){if(e.global)for(;o=e.exec(d);)f.push(m(o,a));else o=d.match(e),f.push(m(o,a));return f.length&&(g=f.length,function(e,t,n){var a,i,o,d,c=[],f=0,g=e,m=t.shift(),h=0;e:for(;;){if((l[g.nodeName]||u[g.nodeName]||r(g))&&f++,3===g.nodeType&&(!i&&g.length+f>=m[1]?(i=g,d=m[1]-f):a&&c.push(g),!a&&g.length+f>m[0]&&(a=g,o=m[0]-f),f+=g.length),a&&i){if(g=n({startNode:a,startNodeIndex:o,endNode:i,endNodeIndex:d,innerNodes:c,match:m[2],matchIndex:h}),f-=i.length-d,a=null,i=null,c=[],h++,!(m=t.shift()))break}else if(s[g.nodeName]&&!l[g.nodeName]||!g.firstChild){if(g.nextSibling){g=g.nextSibling;continue}}else if(!r(g)){g=g.firstChild;continue}for(;;){if(g.nextSibling){g=g.nextSibling;break}if(g.parentNode===e)break e;g=g.parentNode}}}(t,f,function(e){var t;if("function"!=typeof e){var n=e.nodeType?e:c.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(c.createTextNode(e)),r}}else t=e;return function(e){var n,r,a,i=e.startNode,o=e.endNode,d=e.matchIndex;if(i===o){var l=i;a=l.parentNode,e.startNodeIndex>0&&(n=c.createTextNode(l.data.substring(0,e.startNodeIndex)),a.insertBefore(n,l));var s=t(e.match[0],d);return a.insertBefore(s,l),e.endNodeIndex<l.length&&(r=c.createTextNode(l.data.substring(e.endNodeIndex)),a.insertBefore(r,l)),l.parentNode.removeChild(l),s}n=c.createTextNode(i.data.substring(0,e.startNodeIndex)),r=c.createTextNode(o.data.substring(e.endNodeIndex));for(var u=t(i.data.substring(e.startNodeIndex),d),f=[],g=0,m=e.innerNodes.length;g<m;++g){var h=e.innerNodes[g],p=t(h.data,d);h.parentNode.replaceChild(p,h),f.push(p)}var v=t(o.data.substring(0,e.endNodeIndex),d);return(a=i.parentNode).insertBefore(n,i),a.insertBefore(u,i),a.removeChild(i),(a=o.parentNode).insertBefore(v,o),a.insertBefore(r,o),a.removeChild(o),v}}(n))),g}},i=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},o=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},d=function(e,t){var r,a=[];if((r=n.toArray(e.getBody().getElementsByTagName("span"))).length)for(var o=0;o<r.length;o++){var d=i(r[o]);null!==d&&d.length&&d===t.toString()&&a.push(r[o])}return a},c=function(e,t,n){var r=t.get(),a=e.dom;(n=!1!==n)?r++:r--,a.removeClass(d(e,t.get()),"mce-match-marker-selected");var i=d(e,r);return i.length?(a.addClass(d(e,r),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),r):-1},l=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},s=function(e,t){var n=c(e,t,!0);-1!==n&&t.set(n)},u=function(e,t){var n=c(e,t,!1);-1!==n&&t.set(n)},f=function(e){var t=i(e);return null!==t&&t.length>0},g=function(e,t,r){var a,d,c,l;for(d=n.toArray(e.getBody().getElementsByTagName("span")),a=0;a<d.length;a++){var s=i(d[a]);null!==s&&s.length&&(s===t.get().toString()&&(c||(c=d[a].firstChild),l=d[a].firstChild),o(d[a]))}if(c&&l){var u=e.dom.createRng();return u.setStart(c,0),u.setEnd(l,l.data.length),!1!==r&&e.selection.setRng(u),u}},m=function(e,t){return d(e,t.get()+1).length>0},h=function(e,t){return d(e,t.get()-1).length>0},p=g,v=function(e,t,n,r,i){n=(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")).replace(/\s/g,"\\s"),n=i?"\\b"+n+"\\b":n;var o,d,l,s,u,f=(o=e,d=t,l=new RegExp(n,r?"g":"gi"),(u=o.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",s=o.getBody(),g(o,d,!1),a(l,s,u,!1,o.schema));return f&&(t.set(-1),t.set(c(e,t,!0))),f},b=s,x=u,N=function(e,t,r,a,d){var c,g,p,v,b,x,N=t.get();for(a=!1!==a,p=e.getBody(),g=n.grep(n.toArray(p.getElementsByTagName("span")),f),c=0;c<g.length;c++){var y=i(g[c]);if(v=b=parseInt(y,10),d||v===t.get()){for(r.length?(g[c].firstChild.nodeValue=r,o(g[c])):l(e.dom,g[c]);g[++c];){if((v=parseInt(i(g[c]),10))!==b){c--;break}l(e.dom,g[c])}a&&N--}else b>t.get()&&g[c].setAttribute("data-mce-index",b-1)}return t.set(N),a?(x=m(e,t),s(e,t)):(x=h(e,t),u(e,t)),!d&&x},y=m,k=h,C=function(e,t){var r,a={};function i(){d.statusbar.find("#next").disabled(!1===y(e,t)),d.statusbar.find("#prev").disabled(!1===k(e,t))}function o(){e.windowManager.alert("Could not find the specified string.",(function(){d.find("#find")[0].focus()}))}e.undoManager.add(),r=n.trim(e.selection.getContent({format:"text"}));var d=e.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){e.focus(),p(e,t),e.undoManager.add()},onSubmit:function(n){var r,c,l,s;return n.preventDefault(),c=d.find("#case").checked(),s=d.find("#words").checked(),(l=d.find("#find").value()).length?a.text===l&&a.caseState===c&&a.wholeWord===s?y(e,t)?(b(e,t),void i()):void o():((r=v(e,t,l,c,s))||o(),d.statusbar.items().slice(1).disabled(0===r),i(),void(a={text:l,caseState:c,wholeWord:s})):(p(e,t,!1),void d.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){d.submit()}},{text:"Replace",disabled:!0,onclick:function(){N(e,t,d.find("#replace").value())||(d.statusbar.items().slice(1).disabled(!0),t.set(-1),a={})}},{text:"Replace all",disabled:!0,onclick:function(){N(e,t,d.find("#replace").value(),!0,!0),d.statusbar.items().slice(1).disabled(!0),a={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){x(e,t),i()}},{text:"Next",name:"next",disabled:!0,onclick:function(){b(e,t),i()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:r},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})},w=function(e,t){return function(){C(e,t)}};t.add("searchreplace",(function(t){var n=e(-1);return function(e,t){e.addCommand("SearchReplace",(function(){C(e,t)}))}(t,n),function(e,t){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:w(e,t),separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",onclick:w(e,t)}),e.shortcuts.add("Meta+F","",w(e,t))}(t,n),function(e,t){return{done:function(n){return p(e,t,n)},find:function(n,r,a){return v(e,t,n,r,a)},next:function(){return b(e,t)},prev:function(){return x(e,t)},replace:function(n,r,a){return N(e,t,n,r,a)}}}(t,n)}))}();