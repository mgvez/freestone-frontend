!function(){"use strict";var n,e,t,r,o=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return o(t())}}},u=tinymce.util.Tools.resolve("tinymce.PluginManager"),i={" ":"nbsp","­":"shy"},c=function(n,e){var t,r="";for(t in n)r+=t;return new RegExp("["+r+"]",e?"g":"")},a=function(n){var e,t="";for(e in n)t&&(t+=","),t+="span.mce-"+n[e];return t},l={charMap:i,regExp:c(i),regExpGlobal:c(i,!0),selector:a(i),charMapToRegExp:c,charMapToSelector:a},f=function(n){return function(){return n}},s={noop:function(){},noarg:function(n){return function(){return n()}},compose:function(n,e){return function(){return n(e.apply(null,arguments))}},constant:f,identity:function(n){return n},tripleEquals:function(n,e){return n===e},curry:function(n){for(var e=new Array(arguments.length-1),t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=new Array(arguments.length),r=0;r<t.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}},not:function(n){return function(){return!n.apply(null,arguments)}},die:function(n){return function(){throw new Error(n)}},apply:function(n){return n()},call:function(n){n()},never:f(!1),always:f(!0)},d=s.never,m=s.always,p=function(){return v},v=(r={fold:function(n,e){return n()},is:d,isSome:d,isNone:m,getOr:t=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},or:t,orThunk:e,map:p,ap:p,each:function(){},bind:p,flatten:p,exists:d,forall:m,filter:p,equals:n=function(n){return n.isNone()},equals_:n,toArray:function(){return[]},toString:s.constant("none()")},Object.freeze&&Object.freeze(r),r),h=(Array.prototype.indexOf,function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o,n)}return r}),g=(Array.prototype.push,Array.prototype.slice,h),y=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t,n)},w=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:s.constant(n)}},b=function(n){return n.dom().nodeName.toLowerCase()},E=function(n){return n.dom().nodeType},k=function(n){return function(e){return E(e)===n}},x=k(1),T=k(3),C=k(9),N={name:b,type:E,value:function(n){return n.dom().nodeValue},isElement:x,isText:T,isDocument:C,isComment:function(n){return 8===E(n)||"#comment"===b(n)}},A=function(n){return'<span data-mce-bogus="1" class="mce-'+l.charMap[n]+'">'+n+"</span>"},M=function(n,e){var t=[],r=n.dom(),o=g(r.childNodes,w);return y(o,(function(n){e(n)&&(t=t.concat([n])),t=t.concat(M(n,e))})),t},B={isMatch:function(n){return N.isText(n)&&void 0!==N.value(n)&&l.regExp.test(N.value(n))},filterDescendants:M,findParentElm:function(n,e){for(;n.parentNode;){if(n.parentNode===e)return n;n=n.parentNode}},replaceWithSpans:function(n){return n.replace(l.regExpGlobal,A)}},O=function(n,e){var t,r,o=B.filterDescendants(w(e),B.isMatch);y(o,(function(e){var o=B.replaceWithSpans(N.value(e));for(r=n.dom.create("div",null,o);t=r.lastChild;)n.dom.insertAfter(t,e.dom());n.dom.remove(e.dom())}))},S=function(n,e){var t=n.dom.select(l.selector,e);y(t,(function(e){n.dom.remove(e,1)}))},D=O,V=S,P=function(n){var e=n.getBody(),t=n.selection.getBookmark(),r=B.findParentElm(n.selection.getNode(),e);S(n,r=void 0!==r?r:e),O(n,r),n.selection.moveToBookmark(t)},R=tinymce.util.Tools.resolve("tinymce.util.Delay"),q=function(n){return function(e){var t=e.control;n.on("VisualChars",(function(n){t.active(n.state)}))}};u.add("visualchars",(function(n){var e,t=o(!1);return function(n,e){n.addCommand("mceVisualChars",(function(){!function(n,e){var t,r=n.getBody(),o=n.selection;e.set(!e.get()),function(n,e){n.fire("VisualChars",{state:e})}(n,e.get()),t=o.getBookmark(),!0===e.get()?D(n,r):V(n,r),o.moveToBookmark(t)}(n,e)}))}(n,t),(e=n).addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:q(e)}),e.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:q(e),selectable:!0,context:"view",prependToContext:!0}),function(n,e){var t=R.debounce((function(){P(n)}),300);!1!==n.settings.forced_root_block&&n.on("keydown",(function(r){!0===e.get()&&(13===r.keyCode?P(n):t())}))}(n,t),function(n){return{isEnabled:function(){return n.get()}}}(t)}))}();