!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),i=function(e,t,i){var o=function(e){var t="",i=e.dom.encode,o=function(e){return e.getParam("content_style","")}(e);t+='<base href="'+i(e.documentBaseURI.getURI())+'">',o&&(t+='<style type="text/css">'+o+"</style>"),n.each(e.contentCSS,(function(n){t+='<link type="text/css" rel="stylesheet" href="'+i(e.documentBaseURI.toAbsolute(n))+'">'}));var r=e.settings.body_id||"tinymce";-1!==r.indexOf("=")&&(r=(r=e.getParam("body_id","","hash"))[e.id]||r);var c=e.settings.body_class||"";-1!==c.indexOf("=")&&(c=(c=e.getParam("body_class","","hash"))[e.id]||"");var a=e.settings.directionality?' dir="'+e.settings.directionality+'"':"";return"<!DOCTYPE html><html><head>"+t+'</head><body id="'+i(r)+'" class="mce-content-body '+i(c)+'"'+i(a)+">"+e.getContent()+'<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> </body></html>'}(e);if(i)t.src="data:text/html;charset=utf-8,"+encodeURIComponent(o);else{var r=t.contentWindow.document;r.open(),r.write(o),r.close()}};e.add("preview",(function(e){(function(e){e.addCommand("mcePreview",(function(){!function(e){var n=!t.ie,o='<iframe src="" frameborder="0"'+(n?' sandbox="allow-scripts"':"")+"></iframe>",r=function(e){return parseInt(e.getParam("plugin_preview_width","650"),10)}(e),c=function(e){return parseInt(e.getParam("plugin_preview_height","500"),10)}(e);e.windowManager.open({title:"Preview",width:r,height:c,html:o,buttons:{text:"Close",onclick:function(e){e.control.parent().parent().close()}},onPostRender:function(t){var o=t.control.getEl("body").firstChild;i(e,o,n)}})}(e)}))})(e),function(e){e.addButton("preview",{title:"Preview",cmd:"mcePreview"}),e.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})}(e)}))}();